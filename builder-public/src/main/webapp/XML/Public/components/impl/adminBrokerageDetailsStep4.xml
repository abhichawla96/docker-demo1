<projectcomponents project="Public">
<component name="adminBrokerageDetailsStep4" seq="0">
		<action name="view">
			<actionparam evalute="Y" form="Y" name="ProducerOneURL" paramid="ProducerOneURL" pre="Y" val="PublicRule.getProducerOneURL"/>
			<workflow name="view1" seq="0">
				<databaseoperation executionsequence="1" metaobject="tbl_agencyappointmentrequest" name="getTerritoryId" operation="3" sqlstmt="SELECT (SELECT TOP 1 wrs.workflow_function FROM workflowrequestsstatus wrs WHERE wrs.workflowrequests_id = wr.workflowrequests_id           ORDER BY workflowrequestsstatus_id DESC) AS workflow_function        ,(SELECT DESCRIPTION FROM tbl_invitation_status_lku WHERE invitation_status_id=wr.workflowstatus_id) AS aar_statusid_desc        FROM workflowrequests wr WHERE objecttype='Onboarding' AND wr.objectid=#aar_requestid#"/>
				 	<function executionsequence="2" functionid="getThankyouPgeLabels" name="getThankyouPgeLabels" parameters="context"/>	
				 <databaseoperation executionsequence="3" metaobject="tbl_agencyappointmentrequest" name="updateToUserGroup" operation="4" sqlstmt="update workflowrequestsstatus set tousergroup='MarketingAssistant' where workflowrequests_id in(select top 1 workflowrequests_id from workflowrequests where objectid=#aar_requestid# and objecttype='Onboarding')              and workflow_function='Public Submission' and toworkflowstatus_id in(select top 1 invitation_status_id from tbl_invitation_status_lku where description='Sent for Esignature')"/>	
			</workflow>
		<actionparam form="Y" name="removeparams" paramid="removeparams" pre="Y" remove="Y" removeparams="agencyMarketInformation_list_1,isShowMarketInformationDiv,personalinformation_list_listfreeform_1,agencyPremiumVolumeByLOBStep6_list_mom_1     ,agencymergers_list_listfreeform_1,agencyterminated_list_listfreeform_1,agencyMarketInformation_list_listfreeform_1,agencyOfficersPartners_list_listfreeform_1,agencySegmentClasses_list_listfreeform_1,agencyProgramBusiness_list_listfreeform_1" session="Y"/>
		</action>
		<action  name="download">
			<!-- <workflow name="download" seq="0" eval="PublicRule.isInvitationPrincipalTypeNotForPerson"> -->
			
			<actionparam deltaind="I"  executionsequence="13" form="Y" name="registration_type" paramid="registration_type" viewparam="Y"/>
			<actionparam deltaind="I" executionsequence="14" form="Y" post="Y" name="AgentAddresType" paramid="AgentAddresType" val="2" viewparam="Y"/>
			<workflow name="download" seq="0">
				<databaseoperation deltaind="I" executionsequence="0" eval="PublicRule.isRegistrationTypePrimarySeconderyAgency" metaobject="tbl_agencyappointmentrequest" name="getAppointmentRequestData" operation="3" sqlstmt=" select b.master_lookup_data_desc as  entity_type,*,dbo.getAmountFormat(agency_volume) as 'agencyvolume' ,dbo.getAmountFormat(aar_mkttotpremium) as 'marketpremium' ,(select s.description from state_lku s,tbl_agencyappointmentrequest ta where ta.domicile_state=s.state_id and ta.aar_requestid=#aar_requestid#) as state         ,(select description from producertype_lku where prdcrtype_id=ta.aar_producertypeid) as 'legaldescription'        ,(select master_lookup_data_code from master_lookup_data_lku k ,tbl_agencyappointmentrequest v where v.registration_type_id=k.master_lookup_data_id and v.aar_requestid=#aar_requestid#)as registration_type_code,(select b.master_lookup_data_desc as agency_comparativerate_desc from master_lookup_detail_lku a  inner join dbo.master_lookup_data_lku b on a.master_lookup_detail_id = b.master_lookup_detail_id where b.master_lookup_data_id=ta.agency_management_system  )     as agency_management_system_desc        ,stuff((select ', ' + b.master_lookup_data_desc             from tbl_agencyappointmentrequest ta        left join dbo.master_lookup_data_lku b          on b.master_lookup_data_id in  (select items from dbo.split(ta.agency_comparativerate,','))                 left join master_lookup_detail_lku a on a.master_lookup_detail_id = b.master_lookup_detail_id where aar_requestid=31 for xml path('')),1,1,'') as  agency_comparativerate_pdf         from tbl_agencyappointmentrequest ta        left join dbo.master_lookup_data_lku b on b.master_lookup_data_id= ta.entity_type        left join master_lookup_detail_lku a on a.master_lookup_detail_id = b.master_lookup_detail_id where aar_requestid=#aar_requestid#				">
				</databaseoperation>
				<databaseoperation  deltaind="I" executionsequence="0" eval="PublicRule.checkIsRegistrationTypeProducerRegistration" metaobject="tbl_agencyappointmentrequest" name="getAppointmentRequestData1" operation="3" sqlstmt="select x.producer_number, b.master_lookup_data_desc as  entity_type,*,dbo.getAmountFormat(agency_volume) as 'agencyvolume',dbo.getAmountFormat(aar_mkttotpremium) as 'marketpremium' ,(select s.description from state_lku s,tbl_agencyappointmentrequest ta where ta.domicile_state=s.state_id and ta.aar_requestid=#aar_requestid#) as state,(select top 1 s.abbreviation from state_lku s,tbl_address ta where ta.state_id=s.state_id and type=1 order by ta.last_updated_ts desc) as statecode, (Select top 1 ad.addressline1 from tbl_address ad where aar_requestid=#aar_requestid# and type=1 order by last_updated_ts desc)as address1,(Select top 1 ad.addressline2 from tbl_address ad where aar_requestid=#aar_requestid# and type=1 order by last_updated_ts desc)as address2,(Select top 1 ad.city from tbl_address ad where aar_requestid=#aar_requestid# and type=1 order by last_updated_ts desc)as city,(Select top 1 ad.zip from tbl_address ad where aar_requestid=#aar_requestid# and type=1 order by last_updated_ts desc)as zip,(select description from producertype_lku where prdcrtype_id=ta.aar_producertypeid) as 'legaldescription', (select master_lookup_data_code from master_lookup_data_lku k ,tbl_agencyappointmentrequest v where v.registration_type_id=k.master_lookup_data_id and v.aar_requestid=#aar_requestid#) as registration_type_code ,(select b.master_lookup_data_desc as agency_comparativerate_desc   from master_lookup_detail_lku a  inner join dbo.master_lookup_data_lku b on a.master_lookup_detail_id = b.master_lookup_detail_id where b.master_lookup_data_id=ta.agency_management_system  )     as agency_management_system_desc        ,stuff((select ', ' + b.master_lookup_data_desc             from tbl_agencyappointmentrequest ta        left join dbo.master_lookup_data_lku b          on b.master_lookup_data_id in  (select items from dbo.split(ta.agency_comparativerate,','))                 left join master_lookup_detail_lku a on a.master_lookup_detail_id = b.master_lookup_detail_id where aar_requestid=#aar_requestid# for xml path('')),1,1,'') as  agency_comparativerate_pdf         from tbl_agencyappointmentrequest ta left join dbo.master_lookup_data_lku b on b.master_lookup_data_id= ta.entity_type        left join master_lookup_detail_lku a on a.master_lookup_detail_id = b.master_lookup_detail_id inner join producer_number x on x.agency_id = ta.parent_agency_id where aar_requestid=#aar_requestid# ">
				</databaseoperation>
				
				<databaseoperation  deltaind="I" executionsequence="6" metaobject="tbl_agencyappointmentrequest" name="getAgenntQuestionsList" operation="5" sqlstmt="Select Cast((ROW_NUMBER() OVER(ORDER BY questionid ))as varchar) +'.' AS Row,* from (select a.questionid,bg.question,a.response,a.comment,bg.comment_decision from tbl_agentquestions a,backgroundquestions_lku bg         where a.questionid=bg.questionid and a.personid=(select top 1 person_id from tbl_agencyprincipal where request_id=#aar_requestid# order by 1 desc) union        select questionid,question,null as response,null as comment,bg.comment_decision from backgroundquestions_lku bg        where bg.questionid not in(select questionid from tbl_agentquestions where personid=(select top 1  person_id from tbl_agencyprincipal where request_id=#aar_requestid# order by 1 desc)) and bg_question_type=0)t1" viewid="agentQuestions_list_1"/>
   		<databaseoperation  deltaind="I" executionsequence="6" metaobject="tbl_agencyappointmentrequest" name="memberOfList" operation="5" sqlstmt="select concat(pn.producer_number,'-',am.name) as name from producer_number pn,agency_master am, tbl_agencyappointmentrequest t where t.associatedAgency_id=am.agency_id and pn.agency_id=am.agency_id and t.aar_requestid=#aar_requestid#" viewid="memberOf_list_1"/>		
   		<storedprocedureoperation deltaind="I" dbspname="getPrincipalInformation_p" executionsequence="0" id="getPrincipalInformation_p" metaobject="tbl_agencyappointmentrequest" name="getPrincipalInformation_p" operation="5" viewid="agencyListPublicSubmitNInvitationEdit_list_1">
          <parameteroperation indexno="0" mode="IN" property="aar_requestid" seq="1"/>
          <parameteroperation indexno="1" mode="IN" property="AgentAddresType" seq="2"/>
          <resultsetoperation indexno="1" mappingclass="java.util.HashMap" seq="0"/>
        </storedprocedureoperation>
        <databaseoperation deltaind="I" executionsequence="6" metaobject="tbl_agencyappointmentrequest" name="getExtendedFieldData" operation="5" sqlstmt="select top 1 f28 as dividend_distribution, f29 as member_of_hba, f27 as policyholder_copies,f30 as dropdown from configurationclient.html_extendedfields_mapping_data where object_id=#aar_requestid# order by 1 desc" viewid="extendedField_list_1"/>
        
        <databaseoperation deltaind="I" executionsequence="6" metaobject="tbl_agencyappointmentrequest" name="getExtendedFieldDataHba" operation="5" sqlstmt="select md.master_lookup_data_desc as data_desc from master_lookup_data_lku md,master_lookup_detail_lku detail where md.master_lookup_detail_id=detail.master_lookup_detail_id and detail.lookup_table_name='hba_chapter_lku'and md.master_lookup_data_code=(select top 1 f30 from configurationclient.html_extendedfields_mapping_data where object_id=#aar_requestid# order by 1 desc)" viewid="extendedFieldHba_list_1"/>
        
        <databaseoperation deltaind="I" executionsequence="6" metaobject="tbl_agencyappointmentrequest" name="getcyberliability" operation="5" sqlstmt="select carrier_other as cyber_liability_carrier_other,policy_number as cyber_liability_policy_number,coverage_amount as cyber_liability_coverage_amount,cast(policy_limit as numeric(16,0)) as cyber_liability_policy_limit,effective_date as cyber_liability_effective_date,expiration_date as cyber_liability_expiration_date,cyber_liability_claims, comments as cyber_liability_eoclaims_comments from tbl_agency_cyber_liability where aar_requestid=#aar_requestid# " viewid="cyberliability_list_1"/>
        
        <storedprocedureoperation deltaind="I" dbspname="GetAgencyPublicStateDescriptionList_p"  executionsequence="0" id="GetAgencyPublicStateDescriptionList_p_1" metaobject="state_lku" name="GetAgencyPublicStateDescriptionList_p_1" operation="15" viewid="agencyListPublicSubmitEdit_list_mom_3">
          	<parameteroperation indexno="1" mode="IN" property="aar_requestid" seq="1"/>
         	 <resultsetoperation indexno="1" mappingclass="java.util.HashMap" seq="0"/>
        </storedprocedureoperation>
		      
   		<storedprocedureoperation deltaind="I" dbspname="getBankInformationListPone_p_java" executionsequence="18" id="getBankInformationListPone_p_java" metaobject="person" name="getBankInformationListPone_p_java" operation="5" viewid="agencybankinformation1_list_1">
          <parameteroperation indexno="0" mode="IN" property="aar_requestid" seq="1"/>
          <resultsetoperation indexno="1" mappingclass="java.util.HashMap" seq="0"/>
        </storedprocedureoperation>
   				
   		<storedprocedureoperation deltaind="I" dbspname="getAgencyCurrentMarketInfoRecord_p" executionsequence="0" id="getAgencyCurrentMarketInfoRecord_p" metaobject="agencyListPublicSubmitNInvitationEdit" name="getAgencyCurrentMarketInfoRecord_p" operation="3" viewid="getAgencyCurrentMarketInfoRecord_list_1">
          <parameteroperation indexno="0" mode="IN" property="aar_requestid" seq="1"/>
          <resultsetoperation indexno="0" mappingclass="java.util.HashMap" seq="0"/>
        </storedprocedureoperation>
   		
   		<databaseoperation deltaind="I" executionsequence="6" metaobject="tbl_agencyappointmentrequest" name="getMarketInfoData" operation="5" sqlstmt="SELECT marketinformation_lob_id ,aar_requestid,lexis_nexis_node_id,ISNULL(is_allow_incentives,0) as is_allow_incentives,auto_liability_percentage,umbrella_coverage_percentage,renters_coverage_percentage   ,ISNULL(is_producers_dedicated_personal_lines,0) as is_producers_dedicated_personal_lines,ISNULL(is_agency_owner_personal_lines,0) as is_agency_owner_personal_lines,personal_lines_package_policies,ISNULL(is_agency_association_business_commission,0) as is_agency_association_business_commission,   ISNULL(is_service_center_personal_lines,0) as is_service_center_personal_lines,agency_pay_commission_to_producers,ISNULL(is_agency_share_contingency,0) as is_agency_share_contingency,ISNULL(is_agency_commercial_business,0) as is_agency_commercial_business,industry_makeup_agency_commercial,   ISNULL(is_agencys_service_center,0) as is_agencys_service_center,production_commitment_first_year,production_commitment_second_year,production_commitment_third_year,production_commitment_achieve_volume,ISNULL(bonds_billing_option,0) as bonds_billing_option      ,ISNULL(is_premium_mining_discussed,0) as is_premium_mining_discussed,date_to_be_completed,premium_threshold,accounts_size,commercial_premium_threshold from tbl_marketinformation_lob where aar_requestid=#aar_requestid#" viewid="getMarketInfoData_list_1"/>
   		<databaseoperation deltaind="I" executionsequence="6" metaobject="tbl_agencyappointmentrequest" name="getHearAboutData" operation="5" sqlstmt="select top 1 learn_about,interest_in_other_business,interest_for_appointment,agency_experience,agency_financials,perpetuation_plan,marketing_plan,location_of_agency,other_companies_representated,agency_brief_profile  from tbl_agency_review where aar_requestid=#aar_requestid#" viewid="getHearAboutData_list_1"/>	
   </workflow>
		</action>
		<action name="previous"/>
		<action name="adminBrokerageDetailsStep1">
			<actionparam name="inet_skip_validation" paramid="inet_skip_validation" val="Y" viewparam="Y"/>
			<actionparam form="Y" name="inet_eventid" paramid="inet_eventid" pre="Y" session="Y" val="edit"/>
		</action>
		<action name="adminBrokerageDetailsStep2">
			<actionparam name="inet_skip_validation" paramid="inet_skip_validation" val="Y" viewparam="Y"/>
			<actionparam form="Y" name="inet_eventid" paramid="inet_eventid" post="Y" remove="Y" session="Y"/>
		</action>
		<action name="adminBrokerageDetailsStep3">
			<actionparam name="inet_skip_validation" paramid="inet_skip_validation" val="Y" viewparam="Y"/>
			<actionparam form="Y" name="inet_eventid" paramid="inet_eventid" post="Y" remove="Y" session="Y"/>
		</action>
	</component>
</projectcomponents>
